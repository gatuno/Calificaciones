{extends 'calif/base.html'}
{block body}
<h1>NRC {$seccion.nrc}</h1>

<p>De la materia <a href="{url 'Calif_Views_Materia::verMateria', array ($materia.clave)}">{$materia.clave} - {$materia.descripcion}</a> {$seccion.seccion}</p>
<p>Grupo del profesor <a href="{url 'Calif_Views_Maestro::verMaestro', array ($maestro.codigo)}">{$maestro.apellido} {$maestro.nombre}</a>. <a href="{url 'Calif_Views_Seccion::actualizarNrc', array ($seccion.nrc)}">Cambiar de profesor</a></p>
<p><a href="{url 'Calif_Views_Seccion::eliminarNrc', array ($seccion.nrc)}"><img class="icon" src="{media '/img/edit-delete.png'}" alt="Eliminar sección" />Eliminar esta sección</a></p>
{if $user.isCoord()}
	<h3>Oferta académica</h3>
	{if $seccion.asignacion}
		{coordperm 'puede_liberar', $user, $seccion.asignacion}
			<p>La sección está pedida para {$seccion.asignacion}.{if $puede_liberar}<a href="{url 'Calif_Views_Seccion::liberarNrc', array ($seccion.nrc)}">Liberar esta sección</a>.{/if}</p>
	{else}
		{foreach $materia.get_carreras_list as $carrera}
			{coordperm 'puede', $user, $carrera.clave}
			{if $puede}
				<p><a href="{url 'Calif_Views_Seccion::reclamarNrc', array ($seccion.nrc, $carrera.clave)}">Reclamar sección para {$carrera.clave}</a></p>
			{/if}
		{/foreach}
	{/if}
{/if}
<h2>Horarios de la sección</h2>
<p>Puede <a href="{url 'Calif_Views_Horario::agregarHora', array ($seccion.nrc)}">agregar una nueva hora</a> a esta sección</p>
{if $horarios}
	<table border="1">
	<thead><tr><th>Hora inicio</th><th>Hora fin</th><th>Días</th><th>Edificio</th><th>Aula</th><th>Acciones</th></tr></thead>
	<tbody>
	{foreach $horarios as $hora}
		<tr><td>{$hora.inicio}</td>
		<td>{$hora.fin}</td>
		<td>{$hora.displayDias()}</td>
		<td>{$hora.salon_edificio}</td>
		<td><a href="{url 'Calif_Views_Salon::verSalon', array ($hora->salon)}">{$hora.salon_aula}</a></td>
		<td>
		<a href="{url 'Calif_Views_Horario::actualizarHora', array ($seccion->nrc, $hora->id)}"><img class="icon" src="{media '/img/document-properties.png'}" alt="Editar" /></a>
		<a href="{url 'Calif_Views_Horario::eliminarHora', array ($seccion->nrc, $hora->id)}"><img class="icon" src="{media '/img/edit-delete.png'}" alt="Eliminar" /></a>
		</td></tr>
	{/foreach}
	</tbody></table>
{/if}
<h2>Calificaciones</h2>
<p>Sección con {$alumnos|count} alumnos.</p>
{if $alumnos && $grupo_evals}
<div id="Evals_tabs">
	<ul>{foreach $grupo_evals as $geval}
		<li><a href="#{$geval.descripcion}">{$geval.descripcion}</a></li>
	{/foreach}</ul>
	{foreach $grupo_evals as $geval}<div id="{$geval.descripcion}">
	<table border="1">
		<thead><tr><th>Alumno</th><th>Codigo</th>
		{foreach $porcentajes[$geval.id] as $p}
				<th>{$evals[$p.evaluacion].descripcion}</th>
		{/foreach}
		<th>Promedio</th><th></th></tr></thead>
		<tbody>{foreach $alumnos as $alumno}
			<tr><td>{$alumno.apellido} {$alumno.nombre}</td><td>{$alumno.codigo}</td>
			{foreach $porcentajes[$geval.id] as $p}
				<td>{$calificacion[$alumno.codigo][$p.evaluacion] }</td>
			{/foreach}
			<td>{$promedios[$alumno.codigo][$geval.id]}</td>
			<td><a href="{url 'Calif_Views_Alumno::evaluar', array ($alumno->codigo, $seccion->nrc, $id_geval)}"><img class="icon" src="{media '/img/eval.png'}" alt="Evaluar" /></a></td>
			</tr>
		{/foreach}
		<tr><th colspan='2' >Promedio</th>
		{foreach $porcentajes[$geval.id] as $p}
				<td>{$promedios_eval[$p.evaluacion]}</td>
		{/foreach}
		</tr>
		</tbody>
	</table>
	</div>{/foreach}
</div>
{else}
	{if $alumnos}
		<table border="1">
		<thead><tr><th>Alumno</th><th>Codigo</th></tr></thead>
		<tbody>{foreach $alumnos as $alumno}
			<tr><td>{$alumno.apellido} {$alumno.nombre}</td><td>{$alumno.codigo}</td></tr>
		{/foreach}</tbody>
		</table>
	{else}
		<p>La sección no tiene alumnos</p>
	{/if}
{/if}
{/block}
{block javascript}{literal}
<script type="text/javascript">
$(document).ready(function() {
	$('#Evals_tabs').tabs();
});
</script>
{/literal}{/block}
